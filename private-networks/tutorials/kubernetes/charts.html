<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-24.5.2 docs-doc-page docs-doc-id-private-networks/tutorials/kubernetes/charts" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Deploy charts | Besu documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://besu.hyperledger.org/private-networks/tutorials/kubernetes/charts"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="24.5.2"><meta data-rh="true" name="docusaurus_tag" content="docs-default-24.5.2"><meta data-rh="true" name="docsearch:version" content="24.5.2"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-24.5.2"><meta data-rh="true" property="og:title" content="Deploy charts | Besu documentation"><meta data-rh="true" name="description" content="Deploying Besu Helm Charts for a Kubernetes cluster"><meta data-rh="true" property="og:description" content="Deploying Besu Helm Charts for a Kubernetes cluster"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://besu.hyperledger.org/private-networks/tutorials/kubernetes/charts"><link data-rh="true" rel="alternate" href="https://besu.hyperledger.org/private-networks/tutorials/kubernetes/charts" hreflang="en"><link data-rh="true" rel="alternate" href="https://besu.hyperledger.org/private-networks/tutorials/kubernetes/charts" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KD07N5GM2B"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KD07N5GM2B",{anonymize_ip:!0})</script>
<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-THG37T4",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script><link rel="stylesheet" href="/assets/css/styles.19346b99.css">
<script src="/assets/js/runtime~main.f3b68cdb.js" defer="defer"></script>
<script src="/assets/js/main.20dc5ce5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-THG37T4" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-reversed.svg" alt="Besu" class="themedComponent_mlkZ themedComponent--light_NVdE" width="100"><img src="/img/logo-reversed.svg" alt="Besu" class="themedComponent_mlkZ themedComponent--dark_xIcU" width="100"></div></a><a class="navbar__item navbar__link" docid="index" href="/public-networks">Public networks</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" docid="index" href="/private-networks">Private networks</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/public-networks">stable (24.5.2)</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/development/private-networks/tutorials/kubernetes/charts">development</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/private-networks/tutorials/kubernetes/charts">stable (24.5.2)</a></li><li><a class="dropdown__link" href="/24.5.0/private-networks/tutorials/kubernetes/charts">24.5.0</a></li><li><a class="dropdown__link" href="/24.3.0/private-networks/tutorials/kubernetes/charts">24.3.0</a></li><li><a class="dropdown__link" href="/24.1.0/private-networks/tutorials/kubernetes/charts">24.1.0</a></li><li><a class="dropdown__link" href="/23.10.3/private-networks/tutorials/kubernetes/charts">23.10.3</a></li><li><a class="dropdown__link" href="/23.10.2/private-networks/tutorials/kubernetes/charts">23.10.2</a></li><li><a class="dropdown__link" href="/23.7.3/private-networks/tutorials/kubernetes/charts">23.7.3</a></li><li><a class="dropdown__link" href="/23.4.1/private-networks/tutorials/kubernetes/charts">23.4.1</a></li></ul></div><a href="https://github.com/hyperledger/besu/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><a href="https://discord.gg/hyperledger" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discord-link"></a><a href="https://twitter.com/HyperledgerBesu" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-twitter-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/private-networks">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/private-networks/get-started">Get started</a><button aria-label="Collapse sidebar category &#x27;Get started&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/get-started/system-requirements">System requirements</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/private-networks/get-started/install">Install Besu</a><button aria-label="Expand sidebar category &#x27;Install Besu&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/get-started/start-node">Start Besu</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/private-networks/how-to">How to</a><button aria-label="Expand sidebar category &#x27;How to&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/private-networks/concepts">Concepts</a><button aria-label="Expand sidebar category &#x27;Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/private-networks/tutorials">Tutorials</a><button aria-label="Collapse sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/quickstart">Quorum Developer Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/qbft">Create a QBFT network</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/private-networks/tutorials/ibft">Create an IBFT 2.0 network</a><button aria-label="Expand sidebar category &#x27;Create an IBFT 2.0 network&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/clique">Create a Clique network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/ethash">Create an Ethash network</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/private-networks/tutorials/privacy">Create a privacy enabled network</a><button aria-label="Expand sidebar category &#x27;Create a privacy enabled network&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/permissioning">Create a permissioned network</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/private-networks/tutorials/contracts">Deploy a smart contract</a><button aria-label="Expand sidebar category &#x27;Deploy a smart contract&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/private-networks/tutorials/kubernetes">Deploy using Kubernetes</a><button aria-label="Collapse sidebar category &#x27;Deploy using Kubernetes&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/kubernetes/playground">Local playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/kubernetes/cluster">Create a cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/private-networks/tutorials/kubernetes/charts">Deploy charts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/kubernetes/quorum-explorer">Use the Quorum Explorer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/kubernetes/maintenance">Maintenance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/kubernetes/production">Production</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/kubernetes/nat-manager">Configure Kubernetes mode in NAT manager</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/azure">Deploy using Microsoft Azure</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/private-networks/reference">Reference</a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><footer class="theme-doc-footer docusaurus-mt-lg margin-top--sm"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/private-networks">private networks</a></li></ul></div></div></footer><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Deploy charts</h1>
<p>You can deploy Besu Helm charts for a Kubernetes cluster.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<ul>
<li>Clone the <a href="https://github.com/ConsenSys/quorum-kubernetes" target="_blank" rel="noopener noreferrer">Quorum-Kubernetes</a> repository</li>
<li>A <a href="/private-networks/tutorials/kubernetes/cluster">running Kubernetes cluster</a></li>
<li>Install <a href="https://kubernetes.io/docs/tasks/tools/" target="_blank" rel="noopener noreferrer">Kubectl</a></li>
<li>Install <a href="https://helm.sh/docs/intro/install/" target="_blank" rel="noopener noreferrer">Helm3</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="provision-with-helm-charts">Provision with Helm charts<a href="#provision-with-helm-charts" class="hash-link" aria-label="Direct link to Provision with Helm charts" title="Direct link to Provision with Helm charts">​</a></h2>
<p>Helm is a method of packaging a collection of objects into a chart which can then be deployed to the cluster. After you have cloned the <a href="https://github.com/ConsenSys/quorum-kubernetes" target="_blank" rel="noopener noreferrer">Quorum-Kubernetes</a> repository, change the directory to <code>helm</code> for the rest of this tutorial.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd helm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Each helm chart has the following key-map values which you will need to set depending on your needs. The <code>cluster.provider</code> is used as a key for the various cloud features enabled. Please specify only one cloud provider, not both. At present, the charts have full support for cloud native services in both AWS and Azure. Please note that if you use GCP, IBM etc please set <code>cluster.provider: local</code> and set <code>cluster.cloudNativeServices: false</code>.</p>
<p>Please update the <code>aws</code> or <code>azure</code> map as shown below if you deploy to either cloud provider.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cluster:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  provider: local  # choose from: local | aws | azure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cloudNativeServices: false # set to true to use Cloud Native Services (SecretsManager and IAM for AWS; KeyVault &amp; Managed Identities for Azure)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  reclaimPolicy: Delete # set to either Retain or Delete; note that PVCs and PVs will still exist after a &#x27;helm delete&#x27;. Setting to Retain will keep volumes even if PVCs/PVs are deleted in kubernetes. Setting to Delete will remove volumes from EC2 EBS when PVC is deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quorumFlags:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  privacy: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  removeKeysOnDelete: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the aws cli commands uses the name &#x27;quorum-node-secrets-sa&#x27; so only change this if you altered the name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  serviceAccountName: quorum-node-secrets-sa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the region you are deploying to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  region: ap-southeast-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">azure:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the script/bootstrap.sh uses the name &#x27;quorum-pod-identity&#x27; so only change this if you altered the name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  identityName: quorum-pod-identity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the clientId of the user assigned managed identity created in the template</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  identityClientId: azure-clientId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  keyvaultName: azure-keyvault</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the tenant ID of the key vault</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tenantId: azure-tenantId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the subscription ID to use - this needs to be set explicitly when using multi tenancy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subscriptionId: azure-subscriptionId</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Setting the <code>cluster.cloudNativeServices: true</code>:</p>
<ul>
<li>Stores keys in Azure Key Vault or AWS Secrets Manager.</li>
<li>Uses Azure Managed Identities or AWS Identity and Access Management for pod identity access.</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>You can customize any of the charts in this repository to suit your requirements, and make pull requests to extend functionality.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-check-that-you-can-connect-to-the-cluster-with-kubectl">1. Check that you can connect to the cluster with <code>kubectl</code><a href="#1-check-that-you-can-connect-to-the-cluster-with-kubectl" class="hash-link" aria-label="Direct link to 1-check-that-you-can-connect-to-the-cluster-with-kubectl" title="Direct link to 1-check-that-you-can-connect-to-the-cluster-with-kubectl">​</a></h3>
<p>Verify kubectl is connected to cluster using: (use the latest version)</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The result looks similar to:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Client Version: version.Info{Major:&quot;1&quot;, Minor:&quot;23&quot;, GitVersion:&quot;v1.23.1&quot;, GitCommit:&quot;86ec240af8cbd1b60bcc4c03c20da9b98005b92e&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2021-12-16T11:41:01Z&quot;, GoVersion:&quot;go1.17.5&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server Version: version.Info{Major:&quot;1&quot;, Minor:&quot;22&quot;, GitVersion:&quot;v1.22.3&quot;, GitCommit:&quot;c92036820499fedefec0f847e2054d824aea6cd1&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2021-10-27T18:35:25Z&quot;, GoVersion:&quot;go1.16.9&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-create-the-namespace">2. Create the namespace<a href="#2-create-the-namespace" class="hash-link" aria-label="Direct link to 2. Create the namespace" title="Direct link to 2. Create the namespace">​</a></h3>
<p>This tutorial isolates groups of resources (for example, StatefulSets and Services) within a single cluster.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The rest of this tutorial uses <code>besu</code> as the namespace, but you&#x27;re free to pick any name when deploying, as long as it&#x27;s consistent across the <a href="/private-networks/tutorials/kubernetes/cluster">infrastructure scripts</a> and charts.</p></div></div>
<p>Run the following in a terminal window:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create namespace besu</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-deploy-the-monitoring-chart">3. Deploy the monitoring chart<a href="#3-deploy-the-monitoring-chart" class="hash-link" aria-label="Direct link to 3. Deploy the monitoring chart" title="Direct link to 3. Deploy the monitoring chart">​</a></h3>
<p>This chart deploys Prometheus and Grafana to monitor the metrics of the cluster, nodes and state of the network.</p>
<p>Update the admin <code>username</code> and <code>password</code> in the <a href="https://github.com/ConsenSys/quorum-kubernetes/blob/5920caff6dd15b4ca17f760ad9e4d7d2e43b41a1/helm/values/monitoring.yml" target="_blank" rel="noopener noreferrer">monitoring values file</a>. Configure alerts to the receiver of your choice (for example, email or Slack), then deploy the chart using:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add prometheus-community https://prometheus-community.github.io/helm-charts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install monitoring prometheus-community/kube-prometheus-stack --version 34.10.0 --namespace=besu --values ./values/monitoring.yml --wait</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --namespace besu apply -f  ./values/monitoring/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Metrics are collected via a <a href="https://github.com/prometheus-operator/prometheus-operator/blob/7c77626e5e270a2530e187b185d45eeed8a773bf/Documentation/user-guides/getting-started.md" target="_blank" rel="noopener noreferrer">ServiceMonitor</a> that scrapes each Besu pod, using given <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/" target="_blank" rel="noopener noreferrer"><code>annotations</code></a> which specify the port and path to use. For example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  template:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      annotations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        prometheus.io/scrape: &quot;true&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        prometheus.io/port: 9545</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        prometheus.io/path: &quot;/metrics&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>For production use cases, configure Grafana with one of the supported <a href="https://grafana.com/docs/grafana/latest/auth/" target="_blank" rel="noopener noreferrer">native auth mechanisms</a>.</p></div></div>
<p><img loading="lazy" alt="k8s-metrics" src="/assets/images/kubernetes-grafana-f5b7e488c30e4bbacde6f0fba682e0a2.png" width="1918" height="943" class="img_ev3q"></p>
<p>Optionally you can also deploy the <a href="https://www.elastic.co/elastic-stack/" target="_blank" rel="noopener noreferrer">Elastic Stack</a> to view logs (and metrics).</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add elastic https://helm.elastic.co</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># if on cloud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install elasticsearch --version 7.17.1 elastic/elasticsearch --namespace quorum --values ./values/elasticsearch.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># if local - set the replicas to 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install elasticsearch --version 7.17.1 elastic/elasticsearch --namespace quorum --values ./values/elasticsearch.yml --set replicas=1 --set minimumMasterNodes: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install kibana --version 7.17.1 elastic/kibana --namespace quorum --values ./values/kibana.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install filebeat --version 7.17.1 elastic/filebeat  --namespace quorum --values ./values/filebeat.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you install <code>filebeat</code>, please create a <code>filebeat-*</code> index pattern in <code>kibana</code>. All the logs from the nodes are sent to the <code>filebeat</code> index. If you use The Elastic stack for logs and metrics, please deploy <code>metricbeat</code> in a similar manner to <code>filebeat</code> and create an index pattern in Kibana.</p>
<p><img loading="lazy" alt="k8s-elastic" src="/assets/images/kubernetes-elastic-77850ddd9691a3c8f64bd625d3af3a4d.png" width="1919" height="937" class="img_ev3q"></p>
<p>To connect to Kibana or Grafana, we also need to deploy an ingress so you can access your monitoring endpoints publicly. We use Nginx as our ingress here, and you are free to configure any ingress per your requirements.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install quorum-monitoring-ingress ingress-nginx/ingress-nginx \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --namespace quorum \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set controller.ingressClassResource.name=&quot;monitoring-nginx&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set controller.ingressClassResource.controllerValue=&quot;k8s.io/monitoring-ingress-nginx&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set controller.replicaCount=1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set controller.nodeSelector.&quot;kubernetes\.io/os&quot;=linux \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set defaultBackend.nodeSelector.&quot;kubernetes\.io/os&quot;=linux \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set controller.admissionWebhooks.patch.nodeSelector.&quot;kubernetes\.io/os&quot;=linux \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set controller.service.externalTrafficPolicy=Local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f ../ingress/ingress-rules-monitoring.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Once complete, view the IP address listed under the <code>Ingress</code> section if you&#x27;re using the Kubernetes Dashboard or on the command line <code>kubectl -n quorum get services quorum-monitoring-ingress-ingress-nginx-controller</code>.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>We refer to the ingress here as <code>external-nginx</code> because it deals with monitoring endpoints specifically. We also deploy a second ingress called <code>network-ingress</code> which is for the blockchain nodes only in <a href="#9-connect-to-the-node-from-your-local-machine-via-an-ingress">step 8</a></p></div></div>
<p><img loading="lazy" alt="k8s-ingress-external" src="/assets/images/kubernetes-ingress-ip-12a419bfc4a14aa9dee58168f8dc012b.png" width="1902" height="899" class="img_ev3q"></p>
<p>You can view the Besu dashboard by going to:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://&lt;INGRESS_IP&gt;/d/XE4V0WGZz/besu-overview?orgId=1&amp;refresh=10s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can view the Kibana dashboard (if deployed) by going to:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://&lt;INGRESS_IP&gt;/kibana</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-deploy-the-genesis-chart">4. Deploy the genesis chart<a href="#4-deploy-the-genesis-chart" class="hash-link" aria-label="Direct link to 4. Deploy the genesis chart" title="Direct link to 4. Deploy the genesis chart">​</a></h3>
<p>The genesis chart creates the genesis file and keys for the validators.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>It&#x27;s important to keep the release names of the initial validator pool as per this tutorial, that is <code>validator-n</code>, where <code>n</code> is the node number. Any validators created after the initial pool can be named to anything you like.</p></div></div>
<p>The override <a href="https://github.com/ConsenSys/quorum-kubernetes/blob/5920caff6dd15b4ca17f760ad9e4d7d2e43b41a1/helm/values/genesis-besu.yml" target="_blank" rel="noopener noreferrer">values.yml</a> looks like below:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quorumFlags:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  removeGenesisOnDelete: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cluster:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  provider: local  # choose from: local | aws | azure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cloudNativeServices: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the aws cli commands uses the name &#x27;quorum-node-secrets-sa&#x27; so only change this if you altered the name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  serviceAccountName: quorum-node-secrets-sa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the region you are deploying to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  region: ap-southeast-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">azure:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the script/bootstrap.sh uses the name &#x27;quorum-pod-identity&#x27; so only change this if you altered the name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  identityName: quorum-pod-identity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the clientId of the user assigned managed identity created in the template</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  identityClientId: azure-clientId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  keyvaultName: azure-keyvault</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the tenant ID of the key vault</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tenantId: azure-tenantId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the subscription ID to use - this needs to be set explicitly when using multi tenancy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subscriptionId: azure-subscriptionId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># the raw Genesis config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># rawGenesisConfig.blockchain.nodes set the number of validators/signers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rawGenesisConfig:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  genesis:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      chainId: 1337</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      algorithm:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        consensus: qbft # choose from: ibft2 | qbft | clique</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        blockperiodseconds: 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        epochlength: 30000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        requesttimeoutseconds: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gasLimit: &#x27;0x47b760&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    difficulty: &#x27;0x1&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    coinbase: &#x27;0x0000000000000000000000000000000000000000&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  blockchain:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nodes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      generate: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      count: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accountPassword: &#x27;password&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Please set the <code>aws</code>, <code>azure</code> and <code>cluster</code> keys are as per the <a href="#provision-with-helm-charts">Provisioning</a> step. <code>quorumFlags.removeGenesisOnDelete: true</code> tells the chart to delete the genesis file when the chart is deleted. If you may wish to retain the genesis on deletion, please set that value to <code>false</code>.</p>
<p>The last config item is <code>rawGenesisConfig</code> which has details of the chain you are creating, please edit any of the parameters in there to match your requirements. To set the number of initial validators set the <code>rawGenesisConfig.blockchain.nodes</code> to the number that you&#x27;d like. We recommend using the Byzantine formula of <code>N=3F+1</code> when setting the number of validators.</p>
<p>One more thing to note is that when <code>cluster.cloudNativeServices: true</code> is set, the genesis job will not add the <a href="/private-networks/tutorials/quickstart">Quickstart</a> test accounts into the genesis file.</p>
<p>When you are ready deploy the chart with :</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd helm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install genesis ./charts/besu-genesis --namespace besu --create-namespace --values ./values/genesis-besu.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Once completed, view the genesis and enodes (the list of static nodes) configuration maps that every Besu node uses, and the validator and bootnode node keys as secrets.</p>
<p><img loading="lazy" alt="k8s-genesis-configmaps" src="/assets/images/kubernetes-genesis-configmaps-829bdeea072f7fadfe9c440cceff33fd.png" width="1910" height="416" class="img_ev3q"></p>
<p><img loading="lazy" alt="k8s-genesis-secrets" src="/assets/images/kuberenetes-genesis-secrets-01ce3f7990b79414bad9ca1178d66700.png" width="1906" height="789" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-deploy-the-bootnodes">5. Deploy the bootnodes<a href="#5-deploy-the-bootnodes" class="hash-link" aria-label="Direct link to 5. Deploy the bootnodes" title="Direct link to 5. Deploy the bootnodes">​</a></h3>
<p>This is an optional but recommended step. In a production setup we recommend the use of two ore more bootnodes for best practices. Each Besu node has a map that tells the StatefulSet what to deploy and how to clean up. The default <code>values.yml</code> for the StatefulSet define the following flags which are present in all the override values files.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quorumFlags:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  privacy: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  removeKeysOnDelete: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  isBootnode: true    # set this to true if this node is a bootnode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usesBootnodes: true # set this to true if the network you are connecting to use a bootnode/s that are deployed in the cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cluster:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  provider: local  # choose from: local | aws | azure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cloudNativeServices: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  reclaimPolicy: Delete # set to either Retain or Delete; note that PVCs and PVs will still exist after a &#x27;helm delete&#x27;. Setting to Retain will keep volumes even if PVCs/PVs are deleted in kubernetes. Setting to Delete will remove volumes from EC2 EBS when PVC is deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the aws cli commands uses the name &#x27;quorum-node-secrets-sa&#x27; so only change this if you altered the name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  serviceAccountName: quorum-node-secrets-sa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the region you are deploying to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  region: ap-southeast-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">azure:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the script/bootstrap.sh uses the name &#x27;quorum-pod-identity&#x27; so only change this if you altered the name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  identityName: quorum-pod-identity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the clientId of the user assigned managed identity created in the template</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  identityClientId: azure-clientId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  keyvaultName: azure-keyvault</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the tenant ID of the key vault</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tenantId: azure-tenantId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the subscription ID to use - this needs to be set explicitly when using multi tenancy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subscriptionId: azure-subscriptionId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  besu:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metrics:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      serviceMonitorEnabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    resources:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      cpuLimit: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      cpuRequest: 0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      memLimit: &quot;2G&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      memRequest: &quot;1G&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Please set the <code>aws</code>, <code>azure</code> and <code>cluster</code> keys are as per the <a href="#provision-with-helm-charts">Provisioning</a> step. <code>quorumFlags.removeKeysOnDelete: true</code> tells the chart to delete the node&#x27;s keys when the chart is deleted. If you may wish to retain the keys on deletion, please set that value to <code>false</code>.</p>
<p>For the bootnodes only, set the <code>quorumFlags.isBootnode: true</code>. When using bootnodes you have to also set <code>quorumFlags.usesBootnodes: true</code> to indicate that all nodes on the network will use these bootnodes.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>If you use bootnodes, you must set <code>quorumFlags.usesBootnodes: true</code> in the override values.yaml for every other node type, that is validators.yaml, txnode.yaml and reader.yaml</p></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm install bootnode-1 ./charts/besu-node --namespace besu --values ./values/bootnode.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install bootnode-2 ./charts/besu-node --namespace besu --values ./values/bootnode.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Once complete, you see two StatefulSets, and the two bootnodes discover themselves and peer. Because there are no validators present yet, there are no blocks created, as seen in the following logs.</p>
<p><img loading="lazy" alt="k8s-bootnode-logs" src="/assets/images/kubernetes-bootnode-logs-01c0c7d459650185e6acb4f897ef0973.png" width="1909" height="782" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-deploy-the-validators">6. Deploy the validators<a href="#6-deploy-the-validators" class="hash-link" aria-label="Direct link to 6. Deploy the validators" title="Direct link to 6. Deploy the validators">​</a></h3>
<p>The validators peer with the bootnodes and themselves, and when a majority of the validators have peered, blocks are proposed and created on the chain.</p>
<p>These are the next set of nodes that we will deploy. The charts use four validators (default) to replicate best practices for a network. The override <a href="https://github.com/ConsenSys/quorum-kubernetes/blob/5920caff6dd15b4ca17f760ad9e4d7d2e43b41a1/helm/values/validator.yml" target="_blank" rel="noopener noreferrer">values.yml</a> for the StatefulSet looks like below:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quorumFlags:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  privacy: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  removeKeysOnDelete: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  isBootnode: false   # set this to true if this node is a bootnode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usesBootnodes: true # set this to true if the network you are connecting to use a bootnode/s that are deployed in the cluster</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Please set the <code>aws</code>, <code>azure</code> and <code>cluster</code> keys are as per the <a href="#provision-with-helm-charts">Provisioning</a> step. <code>quorumFlags.removeKeysOnDelete: true</code> tells the chart to delete the node&#x27;s keys when the chart is deleted. If you may wish to retain the keys on deletion, please set that value to <code>false</code>.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Please note that if you delete a majority of the validators, the network will halt. Additionally, if the validator keys are deleted you may not be able to recover as you need a majority of the validators up to vote to add new validators into the pool</p></div></div>
<p>When using bootnodes (if deployed in the previous step) you have to also set <code>quorumFlags.usesBootnodes: true</code> to indicate that all nodes on the network will use these bootnodes.</p>
<p>For the initial validator pool we set all the node flags to <code>false</code> and then deploy.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm install validator-1 ./charts/besu-node --namespace besu --values ./values/validator.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install validator-2 ./charts/besu-node --namespace besu --values ./values/validator.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install validator-3 ./charts/besu-node --namespace besu --values ./values/validator.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install validator-4 ./charts/besu-node --namespace besu --values ./values/validator.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>It&#x27;s important to keep the release names of the validators the same as it is tied to the keys that the genesis chart creates. So we use <code>validator-1</code>, <code>validator-2</code>, etc. in the following command.</p></div></div>
<p>Once completed, you may need to give the validators a few minutes to peer and for round changes, depending on when the first validator was spun up, before the logs display blocks being created.</p>
<p><img loading="lazy" alt="k8s-validator-logs" src="/assets/images/kubernetes-validator-logs-85c883d2e1a7e2addc592ab2f3fc62a4.png" width="1904" height="853" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-addremove-additional-validators-to-the-validator-pool">7. Add/Remove additional validators to the validator pool<a href="#7-addremove-additional-validators-to-the-validator-pool" class="hash-link" aria-label="Direct link to 7. Add/Remove additional validators to the validator pool" title="Direct link to 7. Add/Remove additional validators to the validator pool">​</a></h3>
<p>To add (or remove) more validators to the initial validator pool, you need to deploy a node such as an RPC node (step 8) and then <a href="/private-networks/how-to/configure/consensus/ibft#add-and-remove-validators">vote</a> that node in. The vote API call must be made on a majority of the existing pool and the new node will then become a validator.</p>
<p>Please refer to the <a href="#9-connect-to-the-node-from-your-local-machine-via-an-ingress">Ingress Section</a> for details on making the API calls from your local machine or equivalent.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="8-deploy-rpc-or-transaction-nodes">8. Deploy RPC or Transaction nodes<a href="#8-deploy-rpc-or-transaction-nodes" class="hash-link" aria-label="Direct link to 8. Deploy RPC or Transaction nodes" title="Direct link to 8. Deploy RPC or Transaction nodes">​</a></h3>
<p>An RPC node is simply a node that can be used to make public transactions or perform read heavy operations such as when connected to a chain explorer like <a href="https://github.com/blockscout/blockscout" target="_blank" rel="noopener noreferrer">BlockScout</a>.</p>
<p>The RPC override <a href="https://github.com/ConsenSys/quorum-kubernetes/blob/5920caff6dd15b4ca17f760ad9e4d7d2e43b41a1/helm/values/reader.yml" target="_blank" rel="noopener noreferrer">values.yml</a> for the StatefulSet looks identical to that of the validators above, and will create it&#x27;s own node keys before the node starts.</p>
<p>To deploy an RPC node:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm install rpc-1 ./charts/besu-node --namespace besu --values ./values/reader.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A Transaction or Member node in turn is one which has an accompanying Private Transaction Manager, such as Tessera; which allow you to make private transactions between nodes.</p>
<p>The Transaction override <a href="https://github.com/ConsenSys/quorum-kubernetes/blob/5920caff6dd15b4ca17f760ad9e4d7d2e43b41a1/helm/values/txnode.yml" target="_blank" rel="noopener noreferrer">values.yml</a> for the StatefulSet looks identical to that of the validators above and only has <code>quorumFlags.privacy: true</code> to indicate that it is deploying a pair of GoQuorum and Tessera nodes.</p>
<p>To deploy a Transaction or Member node:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm install member-1 ./charts/besu-node --namespace besu --values ./values/txnode.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Logs for <code>member-1</code> resemble the following for Tessera:</p>
<p><img loading="lazy" alt="k8s-tx-tessera-logs" src="/assets/images/kubernetes-tx-tessera-logs-9dc3ebbea91d127a6279fe8fe8e3edcc.png" width="1951" height="602" class="img_ev3q"></p>
<p>Logs for Besu resemble the following:</p>
<p><img loading="lazy" alt="k8s-tx-Besu-logs" src="/assets/images/kubernetes-tx-Besu-logs-86e44cf39e1bad7a0760e75e04663f8e.png" width="1951" height="605" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>In these examples we use <code>member-1</code> and <code>rpc-1</code> as release names for the deployments. You can pick any release name that you&#x27;d like to use in place of those as per your requirements.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="9-connect-to-the-node-from-your-local-machine-via-an-ingress">9. Connect to the node from your local machine via an ingress<a href="#9-connect-to-the-node-from-your-local-machine-via-an-ingress" class="hash-link" aria-label="Direct link to 9. Connect to the node from your local machine via an ingress" title="Direct link to 9. Connect to the node from your local machine via an ingress">​</a></h3>
<p>In order to view the Grafana dashboards or connect to the nodes to make transactions from your local machine you can deploy an ingress controller with rules. We use the <code>ingress-nginx</code> ingress controller which can be deployed as follows:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install quorum-network-ingress ingress-nginx/ingress-nginx \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --namespace quorum \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set controller.ingressClassResource.name=&quot;network-nginx&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set controller.ingressClassResource.controllerValue=&quot;k8s.io/network-ingress-nginx&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set controller.replicaCount=1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set controller.nodeSelector.&quot;kubernetes\.io/os&quot;=linux \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set defaultBackend.nodeSelector.&quot;kubernetes\.io/os&quot;=linux \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set controller.admissionWebhooks.patch.nodeSelector.&quot;kubernetes\.io/os&quot;=linux \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --set controller.service.externalTrafficPolicy=Local</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Use <a href="https://github.com/ConsenSys/quorum-kubernetes/blob/5920caff6dd15b4ca17f760ad9e4d7d2e43b41a1/ingress/ingress-rules-besu.yml" target="_blank" rel="noopener noreferrer">pre-defined rules</a> to test functionality, and alter to suit your requirements (for example, restrict access for API calls to trusted CIDR blocks).</p>
<p>Edit the <a href="https://github.com/ConsenSys/quorum-kubernetes/blob/5920caff6dd15b4ca17f760ad9e4d7d2e43b41a1/ingress/ingress-rules-besu.yml" target="_blank" rel="noopener noreferrer">rules</a> file so that the service names match your release name. In the example, we deployed a transaction node with the release name <code>member-1</code> so the corresponding service is called <code>besu-node-member-1</code>. Once you have settings that match your deployments, deploy the rules as follows:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f ../ingress/ingress-rules-besu.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Once complete, view the IP address listed under the <code>Ingress</code> section if you&#x27;re using the Kubernetes Dashboard or on the command line <code>kubectl -n quorum get services quorum-network-ingress-ingress-nginx-controller</code>.</p>
<p><img loading="lazy" alt="k8s-ingress" src="/assets/images/kubernetes-ingress-ip-12a419bfc4a14aa9dee58168f8dc012b.png" width="1902" height="899" class="img_ev3q"></p>
<p>The following is an example RPC call, which confirms that the node running the JSON-RPC service is syncing:</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">curl HTTP request</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">JSON result</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -v -X POST -H &quot;Content-Type: application/json&quot; --data &#x27;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_blockNumber&quot;,&quot;params&quot;:[],&quot;id&quot;:1}&#x27; http://&lt;INGRESS_IP&gt;/rpc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;id&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;result&quot;: &quot;0x4e9&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="10-blockchain-explorer">10. Blockchain explorer<a href="#10-blockchain-explorer" class="hash-link" aria-label="Direct link to 10. Blockchain explorer" title="Direct link to 10. Blockchain explorer">​</a></h3>
<p>You can deploy <a href="https://github.com/blockscout/blockscout" target="_blank" rel="noopener noreferrer">BlockScout</a> to aid with monitoring the blockchain. To do this, update the <a href="https://github.com/ConsenSys/quorum-kubernetes/blob/5920caff6dd15b4ca17f760ad9e4d7d2e43b41a1/helm/values/blockscout-besu.yml" target="_blank" rel="noopener noreferrer">BlockScout values file</a> and set the <code>database</code> and <code>secret_key_base</code> values.</p>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>Changes to the database requires changes to both the <code>database</code> and the <code>blockscout</code> dictionaries.</p></div></div>
<p>Once completed, deploy the chart using:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm dependency update ./charts/blockscout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install blockscout ./charts/blockscout --namespace quorum --values ./values/blockscout-goquorum.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can optionally deploy the <a href="https://github.com/ConsenSys/quorum-explorer" target="_blank" rel="noopener noreferrer">Quorum-Explorer</a> as a lightweight blockchain explorer. The Quorum Explorer is not recommended for use in production and is intended for demonstration or Development purposes only. The Explorer can give an overview over the whole network, such as querying each node on the network for node or block information, voting (add/remove) validators from the network, demonstrating a SimpleStorage smart contract with privacy enabled, and sending transactions between wallets as you would do in MetaMask. Please see the <a href="/private-networks/tutorials/kubernetes/quorum-explorer">Explorer</a> page for details on how to use the application.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>The accounts listed in the file below are for test purposes only and should not be used on a production network.</p></div></div>
<p>To deploy the application, update the <a href="https://github.com/ConsenSys/quorum-kubernetes/blob/5920caff6dd15b4ca17f760ad9e4d7d2e43b41a1/helm/values/explorer-besu.yaml" target="_blank" rel="noopener noreferrer">Explorer values file</a> with details of your nodes and endpoints and then deploy.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm install quorum-explorer ./charts/explorer --namespace besu --values ./values/explorer-besu.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You will also need deploy the ingress (if not already done in <a href="#3-deploy-the-monitoring-chart">Monitoring</a> to access the endpoint on <code>http://&lt;INGRESS_IP&gt;/explorer</code></p>
<p><img loading="lazy" alt="k8s-explorer" src="/assets/images/kubernetes-explorer-41af1feb005383ef1871e47d4792c3b5.png" width="1917" height="944" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/hyperledger/besu-docs/tree/main/versioned_docs/version-24.5.2/private-networks/tutorials/kubernetes/charts.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_VsjB"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-06-10T10:30:41.000Z">Jun 10, 2024</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/private-networks/tutorials/kubernetes/cluster"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Create a cluster</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/private-networks/tutorials/kubernetes/quorum-explorer"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Use the Quorum Explorer</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#provision-with-helm-charts" class="table-of-contents__link toc-highlight">Provision with Helm charts</a><ul><li><a href="#1-check-that-you-can-connect-to-the-cluster-with-kubectl" class="table-of-contents__link toc-highlight">1. Check that you can connect to the cluster with <code>kubectl</code></a></li><li><a href="#2-create-the-namespace" class="table-of-contents__link toc-highlight">2. Create the namespace</a></li><li><a href="#3-deploy-the-monitoring-chart" class="table-of-contents__link toc-highlight">3. Deploy the monitoring chart</a></li><li><a href="#4-deploy-the-genesis-chart" class="table-of-contents__link toc-highlight">4. Deploy the genesis chart</a></li><li><a href="#5-deploy-the-bootnodes" class="table-of-contents__link toc-highlight">5. Deploy the bootnodes</a></li><li><a href="#6-deploy-the-validators" class="table-of-contents__link toc-highlight">6. Deploy the validators</a></li><li><a href="#7-addremove-additional-validators-to-the-validator-pool" class="table-of-contents__link toc-highlight">7. Add/Remove additional validators to the validator pool</a></li><li><a href="#8-deploy-rpc-or-transaction-nodes" class="table-of-contents__link toc-highlight">8. Deploy RPC or Transaction nodes</a></li><li><a href="#9-connect-to-the-node-from-your-local-machine-via-an-ingress" class="table-of-contents__link toc-highlight">9. Connect to the node from your local machine via an ingress</a></li><li><a href="#10-blockchain-explorer" class="table-of-contents__link toc-highlight">10. Blockchain explorer</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Public networks</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/public-networks">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/public-networks/how-to">How to guides</a></li><li class="footer__item"><a class="footer__link-item" href="/public-networks/concepts">Concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/public-networks/tutorials">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/public-networks/reference">Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Private networks</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/private-networks">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/private-networks/how-to">How to guides</a></li><li class="footer__item"><a class="footer__link-item" href="/private-networks/concepts">Concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/private-networks/tutorials">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/private-networks/reference">Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/hyperledger" target="_blank" rel="noopener noreferrer" class="footer__link-item">Hyperledger Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://wiki.hyperledger.org/display/BESU/Hyperledger+Besu" target="_blank" rel="noopener noreferrer" class="footer__link-item">Hyperledger Besu Wiki<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/HyperledgerBesu" target="_blank" rel="noopener noreferrer" class="footer__link-item">Hyperledger Besu Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/hyperledger/besu/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Hyperledger Besu GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/hyperledger/besu-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Hyperledger Besu documentation GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.hyperledger.org/use/besu" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/logo.svg" alt="Hyperledger Besu logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="250"><img src="/img/logo-reversed.svg" alt="Hyperledger Besu logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="250"></a></div><div class="footer__copyright">Hyperledger Besu and its documentation are licensed under the Apache 2.0 license.</div></div></div></footer></div>
</body>
</html>